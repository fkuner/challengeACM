# aoj 2200 Mr.Rito Post Office
>题目链接：http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=2200
>
>参考：http://www.hankcs.com/program/cpp/aoj-2200-mr-rito-post-office-题解-《挑战程序设计竞赛》.html

## 题意
快递到了：你是某个岛国（ACM-ICPC Japan）上的一个苦逼程序员，你有一个当邮递员的好基友利腾桑遇到麻烦了：全岛有一些镇子通过水路和旱路相连，走水路必须要用船，在X处下船了船就停在X处。而且岛上只有一条船，下次想走水路还是得回到X处才行；两个镇子之间可能有两条以上的水路或旱路；邮递员必须按照清单上的镇子顺序送快递（镇子可能重复，并且对于重复的镇子不允许一次性处理，比如ABCB的话B一定要按顺序走两次才行）。

测试数据有多组：

N M

x1 y1 t1 sl1

x2 y2 t2 sl2

…

xM yM tM slM

R

z1 z2 … zR

N (2 ≤ N ≤ 200) 是镇子的数量，M (1 ≤ M ≤ 10000) 是旱路和水路合计的数量。从第2行到第M + 1行是路径的描述，路径连接xi  yi两地，路径花费 ti (1 ≤ ti ≤ 1000)时间，sli 为L时表示是旱路，S时表示是水路。可能有两条及以上路径连接两个镇子，并且路径都是双向的。

M + 2行的R是利腾需要去的镇子的数量，M + 3是利腾需要去的镇子的编号。

初始状态利腾和船都在第一个镇子，且肯定有方法达到需要去的镇子。

测试数据为0 0的时候表示终止。

Sample Input：

```
3 3
1 2 5 L
1 2 7 S
2 3 11 S
3
1 2 3
5 5
1 2 15 L
2 3 10 L
4 5 7 L
1 3 30 S
3 4 100 S
5
1 3 5 4 1
0 0
```

Output for the Sample Input

```
18
269
```

## 问题分析

## 代码